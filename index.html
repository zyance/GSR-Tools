<!DOCTYPE html>
<html lang="de">
<head> 
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
<link rel="stylesheet" href="assets/css/style.css">
<title>Gründerzeithaus Sanierungs-Berater</title>

<style>

/* =====================================================
   GRUNDVARIABLEN
===================================================== */
:root{
  --hellgrau:#f2f2f2;
  --mittelgrau:#b5b5b5;
  --textgrau:#333333;
  --baukult:#7090a7;
}

/* =====================================================
   BASIS
===================================================== */
* { box-sizing: border-box; }

html { font-size: 20px; }

body {
  margin: 0;
  padding: 20px 0;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  font-family: "Fira Sans", Arial, system-ui, sans-serif;
  font-weight: 300;
  font-size: 1rem;
  line-height: 1.5;
  color: var(--textgrau);
  background-color: #5c88a1;
}

/* =====================================================
   TYPOGRAFIE
===================================================== */
h1, h2, h3 {
  font-family: "Fira Sans", Arial, sans-serif;
  font-weight: 500;
  color: var(--textgrau);
}

.note {
  font-size: 1rem;
  color: #666;
  line-height: 1.5;
}

/* =====================================================
   APP-RAHMEN
===================================================== */
.app-container {
  width: 100%;
  max-width: 600px;
  background: #ffffff;
  box-shadow: 0 10px 25px rgba(0,0,0,0.25);
}

.header-image img {
  width: 100%;
  height: auto;
  display: block;
}

.content {
  padding: 5%;
  text-align: center;
}

/* =====================================================
   BOXEN
===================================================== */
.box {
  width: 92%;
  margin: 3% auto;
  padding: 3%;
  background: #fff;
  border: 1px solid var(--hellgrau);
  border-radius: 6px;
}

.summary-box { background: var(--hellgrau); }

/* =====================================================
   FORMULARFELDER
===================================================== */
input[type="number"],
input[type="text"] {
  width: 33%;
  padding: 8px;
  font-size: 1rem;
  border: 1px solid var(--mittelgrau);
  border-radius: 4px;
  position: relative;
  z-index: 10;
  pointer-events: auto;
}

/* =====================================================
   BUTTONS
===================================================== */
button {
  background: var(--baukult);
  color: #fff;
  border: none;
  border-radius: 6px;
  padding: 12px 24px;
  font-size: 1rem;
  font-family: "Fira Sans", Arial, sans-serif;
  font-weight: 500;
  cursor: pointer;
}

button:hover { background: #5a7a91; }

.box button {
  display: block;
  margin: 0 auto;
}

/* =====================================================
   GRID
===================================================== */
.grid-container {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
}

.grid-btn {
  background: #cbddec;
  border: 1px solid var(--textgrau);
  border-radius: 6px;
  padding: 6px;
  cursor: pointer;
}

.grid-btn:hover { background: #e0e0e0; }

.grid-btn.active {
  background: #ffffff;
  border-color: #000;
  border-width: 2px;
}

.grid-btn img {
  width: 100%;
  display: block;
  pointer-events: none;
}

/* =====================================================
   ACCORDION
===================================================== */
.accordion-header {
  background: var(--hellgrau);
  padding: 12px;
  border-radius: 6px;
  display: flex;
  justify-content: space-between;
  font-weight: 500;
  cursor: pointer;
  user-select: none;
}

.accordion-header:hover { background: var(--mittelgrau); }

.accordion-content {
  display: none;
  padding-top: 12px;
}

.accordion-content.open { display: block; }

/* =====================================================
   SLIDER
===================================================== */
input[type="range"] {
  width: 100%;
  height: 20px;
  appearance: none;
  border-radius: 10px;
  cursor: pointer;
}

input[type="range"]::-webkit-slider-thumb,
input[type="range"]::-moz-range-thumb {
  width: 24px;
  height: 24px;
  background: #333;
  border-radius: 50%;
  border: none;
  cursor: pointer;
}

/* Fensteralter: alt links, neu rechts */
#fensterAlter { direction: rtl; }

/* NEU: Einheitliche Skala */
.slider-scale {
  display: flex;
  justify-content: space-between;
  font-size: 12px;
  margin-top: 4px;
}

/* =====================================================
   SWITCH
===================================================== */
.switch {
  position: relative;
  display: inline-block;
  width: 60px;
  height: 34px;
  z-index: 1;
}

.switch input {
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  inset: 0;
  background-color: #7090a7;
  border-radius: 15px;
  transition: .3s;
  pointer-events: none;
}

.slider:before {
  content: "";
  position: absolute;
  width: 26px;
  height: 26px;
  left: 4px;
  bottom: 4px;
  background-color: white;
  border-radius: 50%;
  transition: .3s;
}

input:checked + .slider:before {
  transform: translateX(26px);
}

/* NEU: PV-Block zentriert */
.main-wrapper {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 12px;
}

/* =====================================================
   SUMMARY
===================================================== */
#summaryText ul {
  list-style: none;
  padding: 0;
  margin: 0;
  text-align: left;
}

#summaryText li {
  padding: 6px 0;
  border-bottom: 1px solid #ddd;
}

#summaryText li:last-child { border-bottom: none; }

/* =====================================================
   AUSWERTUNG
===================================================== */
#auswertungText {
  white-space: pre-wrap;
  line-height: 1.6;
  font-size: 1rem;
}

</style>
</head>

<body>
<div class="app-container">

<!-- HEADER IMAGE -->
<div class="header-image">
  <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjmDFrR6H0SJzmUI-Xgbh8cxS77152EE03Bg4_NISF-KsvKkc_VYMBeLft6zowFFEGykT2BZiIZF2FTWeOFj2_mbipFBhvPxde2jmFi3MNH2WH7bmB-esFDNXSs81xeW5E10n-1CaK0zFiItf1Oqgece8P7Nd7vzyUxZwsjxBL90cNdXkg9QojJbGw19xTD/s1600/baukult_logo.png">
</div>

<!-- WELCOME -->
<div class="content">
  <h2>„Willkommen beim<br/>Gründerzeithaus-Helfer!"</h2>
</div> 

<!-- THERMISCHE SANIERUNG -->
<div class="box">
  <div class="accordion-header" onclick="toggleAccordion(this)">
    <span>Thermische Sanierung</span><span>▼</span>
  </div>
  <div class="accordion-content">

    <h3>Die Bebauung des Grundstücks</h3>
    <input type="hidden" id="building_type">

    <div class="grid-container">
      <!-- deine Bebauungs-Buttons bleiben hier unverändert -->
    </div>

    <!-- NEU: Leerzeile -->
    <br>
    <h3>Zustand des Hauses:</h3>
    <label><input type="radio" name="haus_zustand" value="schlecht"> dringend sanierungsbedürftig</label><br>
    <label><input type="radio" name="haus_zustand" value="zufrieden"> zufriedenstellend</label><br>
    <label><input type="radio" name="haus_zustand" value="sehr gut"> ausgezeichnet, gepflegt</label><br>

    <!-- NEU: Leerzeile -->
    <br>
    <h3>Art der Fenster:</h3>
    <label><input type="radio" name="fenster_art" value="Kastenfenster"> Wiener Kastenfenster</label><br>
    <label><input type="radio" name="fenster_art" value="2-fach"> 2-fach</label><br>
    <label><input type="radio" name="fenster_art" value="3-fach"> 3-fach</label><br>

    <h3 style="margin-top: 20px;">Alter der Fenster: <span id="fensterWert">25</span> Jahre</h3>
    <input type="range" id="fensterAlter" min="1" max="50" value="25"
      style="background:linear-gradient(to left,#4caf50 1%,#4caf50 30%,#fbc02d 30%,#fbc02d 60%,#e53935 60%,#e53935 100%)">

    <!-- NEU: saubere Skala -->
    <div class="slider-scale">
      <span>sehr alt</span>
      <span>neuwertig</span>
    </div>

  </div>
</div>

<!-- HEIZUNG & WARMWASSER -->
<div class="box">
  <div class="accordion-header" onclick="toggleAccordion(this)">
    <span>Heizung & Warmwasser</span><span>▼</span>
  </div>
  <div class="accordion-content">

    <h3>Raumklima: <span id="tempWert">21</span> °C</h3>
    <input type="range" id="raumtemp" min="17" max="25" value="21"
      style="background:linear-gradient(to right,#b3e5fc 0%,#e57373 100%)">

    <!-- NEU: Skala über volle Breite -->
    <div class="slider-scale">
      <span>17°</span>
      <span>19°</span>
      <span>21°</span>
      <span>23°</span>
      <span>25°</span>
    </div>

    <div class="rating">Empfinden: <span id="tempText">angenehm</span></div>

  </div>
</div>

<!-- PHOTOVOLTAIK -->
<div class="box">
  <div class="accordion-header" onclick="toggleAccordion(this)">
    <span>Photovoltaik-Anlage</span><span>▼</span>
  </div>
  <div class="accordion-content">

    <h3 style="margin-top: 20px;">Dachausrichtung:</h3>
    <input type="hidden" id="pv_ausrichtung" value="Süd">

    <!-- NEU: Block zentriert -->
    <div class="main-wrapper">
      <span id="label-sued" class="label label-left is-active">Süd</span>
      <label class="switch">
        <input type="checkbox" id="dachAusrichtung">
        <span class="slider"></span>
      </label>
      <span id="label-ow" class="label label-right">Ost/West</span>
    </div>  

  </div>
</div> 

<!-- ZUSAMMENFASSUNG -->
<div class="box summary-box">
  <h3>Zusammenfassung</h3>
  <div id="summaryText">Noch keine Eingaben.</div>
</div>

<!-- ZUR AUSWERTUNG -->
<div class="box">
  <button type="button" onclick="weiter()">Zur Auswertung</button>
</div>

<div class="box summary-box" id="auswertungBox" style="display:none;">
  <h3>Erste Einschätzung – Phase 1</h3>
  <div id="auswertungText" class="note"></div>
</div>

<script>
/* =========================
   DEIN GESAMTER JS-BLOCK
   HIER 100 % UNVERÄNDERT
========================= */

/* =====================================================
   ACCORDION FUNCTION
===================================================== */
function toggleAccordion(header) {
  var content = header.nextElementSibling;
  var arrow = header.querySelector("span:last-child");
  if (!content) return;
  content.classList.toggle("open");
  if (arrow) {
    arrow.textContent = content.classList.contains("open") ? "▲" : "▼";
  }
}

/* =====================================================
   HELPER FUNCTIONS
===================================================== */

/* GET STRING */
function getString(id) {
  var el = document.getElementById(id);
  if (!el) return null;
  return el.value !== "" ? el.value : null;
}

/* GET NUMBER */
function getNumber(id) {
  var el = document.getElementById(id);
  if (!el) return null;
  if (el.value === "") return null;
  var n = Number(el.value);
  return Number.isFinite(n) ? n : null;
}

/* GET RADIO */
function getRadio(name) {
  var checked = document.querySelector('input[name="' + name + '"]:checked');
  return checked ? checked.value : null;
}

/* =====================================================
   COLLECT DATA
   (IDs must match HTML exactly)
===================================================== */
function collectData() {

  /* heating systems */
  var heating = [];
  if (document.getElementById("fernwaerme")?.checked) heating.push("Fernwärme");
  if (document.getElementById("gas")?.checked) heating.push("Gas / Öl zentral");
  if (document.getElementById("dezGas")?.checked) heating.push("Gasthermen dezentral");
  if (document.getElementById("elektrisch")?.checked) heating.push("Elektrisch");

  /* renovation goals */
  var goals = [];
  if (document.getElementById("kosten_senken")?.checked) goals.push("Kosten senken");
  if (document.getElementById("komfort")?.checked) goals.push("Komfort steigern");
  if (document.getElementById("gaslos")?.checked) goals.push("Raus aus Gas und Öl");
  if (document.getElementById("klima")?.checked) goals.push("Klimaschutz");

  /* roles */
  var roles = [];
  if (document.getElementById("eigentuemer")?.checked) roles.push("Eigentümer:in");
  if (document.getElementById("weg")?.checked) roles.push("WEG");
  if (document.getElementById("mieter")?.checked) roles.push("Mieter:in");
  if (document.getElementById("hausverwaltung")?.checked) roles.push("Hausverwaltung");
  if (document.getElementById("energieberater")?.checked) roles.push("Energieberater:in");

  return {
    building_phase: getString("bauphase"),
    building_type: getString("building_type"),
    roles: roles,
    living_area_m2: getNumber("area_m2"),            // Wohnfläche
floors_total: getNumber("floor_count"),          // Geschosse
windows_per_floor: getNumber("windows_per_floor"), // Fenster/Geschoss
postal_code: getNumber("postal_code"),           // PLZ
    building_condition: getRadio("haus_zustand"),
    window_type: getRadio("fenster_art"),
    window_age_years: getNumber("fensterAlter"),
    heating: heating,
    indoor_temp_c: getNumber("raumtemp"),
    roof_type: getString("dachform"),
    roof_orientation: getString("pv_ausrichtung"),
    goals: goals
  };
}

/* =====================================================
   SUMMARY UPDATE
===================================================== */

function updateSummary() {
  var d = collectData();
  var box = document.getElementById("summaryText");
  if (!box) return;

  // Anfangszustand
  if (
    !d.building_phase &&
    d.living_area_m2 === null &&
    d.floors_total === null
  ) {
    box.innerHTML = "Noch keine Eingaben.";
    return;
  }

  // Zusammenfassung anzeigen
  box.innerHTML =
    "<ul>" +
    "<li>Bauphase: " + (d.building_phase ?? "–") + "</li>" +
    "<li>Wohnfläche: " + (d.living_area_m2 !== null ? d.living_area_m2 + " m²" : "–") + "</li>" +
    "<li>Geschosse: " + (d.floors_total ?? "–") + "</li>" +
    "<li>Fenster/Geschoss: " + (d.windows_per_floor ?? "–") + "</li>" +
    "<li>Postleitzahl: " + (d.postal_code ?? "–") + "</li>" +
    "<li>Bebauung: " + (d.building_type ?? "–") + "</li>" +
    "<li>Zustand: " + (d.building_condition ?? "–") + "</li>" +
    "<li>Fenster: " + (d.window_type ?? "–") +
      (d.window_age_years !== null ? " (" + d.window_age_years + " Jahre)" : "") +
    "</li>" +
    "<li>Heizung: " + (d.heating.length ? d.heating.join(", ") : "keine Angabe") + "</li>" +
    "<li>Raumklima: " + (d.indoor_temp_c !== null ? d.indoor_temp_c + " °C" : "–") + "</li>" +
    "<li>Dach: " + (d.roof_type ?? "–") + " / " + (d.roof_orientation ?? "–") + "</li>" +
    "<li>Ziele: " + (d.goals.length ? d.goals.join(", ") : "keine Angabe") + "</li>" +
    "</ul>";
}

/* =====================================================
   SLIDER EVENTS
===================================================== */
var fensterAlter = document.getElementById("fensterAlter");
if (fensterAlter) {
  fensterAlter.addEventListener("input", function () {
    var out = document.getElementById("fensterWert");
    if (out) out.textContent = this.value;
    updateSummary();
  });
}

var raumtemp = document.getElementById("raumtemp");
if (raumtemp) {
  raumtemp.addEventListener("input", function () {
    var out = document.getElementById("tempWert");
    if (out) out.textContent = this.value;
    var txt = "angenehm";
    if (this.value < 20) txt = "eher kühl";
    if (this.value > 22) txt = "eher warm";
    var t = document.getElementById("tempText");
    if (t) t.textContent = txt;
    updateSummary();
  });
}

/* =====================================================
   GRID BUTTONS
===================================================== */
function setupGridButtons(buttonClass, hiddenInputId) {
  var buttons = document.querySelectorAll("." + buttonClass);
  var hiddenInput = document.getElementById(hiddenInputId);
  if (!hiddenInput) return;

  buttons.forEach(function (btn) {
    btn.addEventListener("click", function () {
      buttons.forEach(function (b) { b.classList.remove("active"); });
      btn.classList.add("active");
      hiddenInput.value = btn.dataset.value || "";
      updateSummary();
    });
  });
}

setupGridButtons("bauphase-btn", "bauphase");
setupGridButtons("building-btn", "building_type");
setupGridButtons("dachform-btn", "dachform");

/* =====================================================
   ROOF ORIENTATION SWITCH
===================================================== */
var dachSwitch = document.getElementById("dachAusrichtung");
var pvInput = document.getElementById("pv_ausrichtung");
var labelSued = document.getElementById("label-sued");
var labelOW = document.getElementById("label-ow");

if (dachSwitch && pvInput) {
  function updateRoofOrientation() {
    if (dachSwitch.checked) {
      pvInput.value = "Ost/West";
      labelOW?.classList.add("is-active");
      labelSued?.classList.remove("is-active");
    } else {
      pvInput.value = "Süd";
      labelSued?.classList.add("is-active");
      labelOW?.classList.remove("is-active");
    }
    updateSummary();
  }
  dachSwitch.addEventListener("change", updateRoofOrientation);
  updateRoofOrientation();
}


